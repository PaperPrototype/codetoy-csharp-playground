# Codetoy CSharp Playground

> [!NOTE]
> Any C code or dll files are auto generated by dotnet build and do not represent any handwritten interop code.

> [!IMPORTANT]
> This is a work in progress. At this very moment the only thing this does is serve as a starting point for using C# with sveltekit

A fully featured C# playground with access to [CanvasRenderingContext2D](https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D) and basic browser input events

### Running

Build the C# code

```sh
npm run build:dotnet # build C# code -> src/libs/dotnet
npm install # install sveltekit libs
npm run dev # run app
```

Or with pnpm

```sh
pnpm run build:dotnet
pnpm install
pnpm run dev
```

### How it works

Contains a .NET 7.0 project in the `dotnet` folder. When compiling the C# project uses the `<WasmAppDir>../src/lib/dotnet</WasmAppDir>` to put the wasm files into your lib folder.

### As a library

This is a sveltekit library project. See relevant docs for more info [Sveltekit Packaging Docs](https://svelte.dev/docs/kit/packaging). Once it reaches maturity and has successfully achieved it's goal of making a full C# playground in the browser it can be published as an open source library on npm.

### Resources

The documentation for getting a csharp compiler in the browser is very lacking but here is a non-comprehensive list of the resources I managed to get my hands on:

- A simple nuget package to run C# code in a WASM-compatible browser https://github.com/unoplatform/Uno.Wasm.Bootstrap
- Official .NET 7.0 announcement "Use .NET from any JavaScript app in .NET 7" https://devblogs.microsoft.com/dotnet/use-net-7-from-any-javascript-app-in-net-7/
- A basic example setup that I used to get this repo working (linked in the official .NET 7.0 annoucement), does not include browser based C# compilation https://github.com/maraf/dotnet-wasm-react
- A full working C# compiler for compiling C# code in the browser (big thanks to @wulferis) https://github.com/PaperPrototype/wulferis-wasm-csharp-compiler
- Another full working C# compiler for compiling C# code in the browser using react https://github.com/JakeYallop/WasmSharp
- Stack overflow post with links to wasm based raytracer https://stackoverflow.com/questions/68927533/c-sharp-wasm-without-blazor
- A simple raytracer built with html canvas and C# https://github.com/dotnet/runtime/blob/0d20f9ad3e0fd58a510062757b34f76a3c122b25/src/mono/sample/wasm/simple-raytracer/main.js

Some other useful tidbits:

- "Configuring and hosting .NET WebAssembly applications" https://github.com/dotnet/runtime/blob/main/src/mono/wasm/features.md
- "[browser] Support for OutputType Library" https://github.com/dotnet/runtime/issues/89577
- "Smooth out support for running .NET from JS via WebAssembly" https://github.com/dotnet/runtime/issues/77191
- "Configurable wwwroot for StaticWebAssets" https://github.com/dotnet/sdk/pull/34178
- "Revisit hot reload browser refresh script injection" https://github.com/dotnet/aspnetcore/issues/45213
- "Error loading blazor webassembly application with modified base path and using a reverse proxy" https://github.com/dotnet/aspnetcore/issues/52417
- "Mono wasm features.md from official dotnet runtime repo" https://github.com/dotnet/runtime/blob/0d20f9ad3e0fd58a510062757b34f76a3c122b25/src/mono/wasm/features.md?plain=1#L158
- "[WASM] Better double (F64) support in MonoPlatform.ts" https://github.com/dotnet/runtime/issues/65959 (Related to the ratracer example)
- "WasmerSharp" https://github.com/migueldeicaza/WasmerSharp/blob/master/docfx/articles/intro.md/
- "Build native WebAssembly components with .NET and C#â€”and deploy on wasmCloud" https://wasmcloud.com/blog/2024-09-05-build-wasm-components-dotnet-wasmcloud/

Unrelated but useful:

- Running Javascript through C# https://andrewlock.net/running-javascript-in-a-dotnet-app-with-javascriptengineswitcher/
